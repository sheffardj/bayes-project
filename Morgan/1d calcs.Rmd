---
title: "Untitled"
output: pdf_document
date: "2022-11-17"
---

$$
p(\sigma|x) = \frac{p(\sigma)p(x|\sigma)}{\int p(\sigma)p(x|\sigma)}\\

$$

Working with the logit normal we will first calculate the top of the fraction 
```{r}
library(logitnorm)
dats1 <- rlogitnorm(15000, 0, 3.16)
dats2 <- rlogitnorm(15000, 0, 1.78)
dats3 <- rlogitnorm(15000, 0, .32)


```

# the priors 
```{r}
un <- function (d) {
  dunif(d, -1, 1)
  }
nor <- function (d){
  dnorm(d, 0, 1)
  }
bet <- function(d){
  dbeta(d, .5, .5)
}

```
# funtion to out put the graph and estimates
```{r}
est.calc <- function(dat, prior, s){
  est <- mean(dlogitnorm(dat, 0, s)*prior)
  # hist(dlogitnorm(dats, 1,2.7)*dunif(dats,-1,1), probability = T, breaks = 50)

  hist(dat, probability = T, ylim = c(0,5))
  curve(dlogitnorm(x, 0, s), col = 'red', add = T)
  curve(dlogitnorm(x, 1, est), col ='blue', add = T)
  print(est)
}


```

# logitnorm sigma = 3.16
```{r}
est.calc(dats1, prior = un(dats1), 3.16)
est.calc(dats1, nor(dats1), 3.16)
est.calc(dats1, bet(dats1), 3.16)

```

# logitnorm with sigma = 1.78
```{r}
est.calc(dats2, un(dats2), 1.78)
est.calc(dats2, nor(dats2), 1.78)
est.calc(dats2, bet(dats2), 1.78)

```

#logitnorm sigma = .32
```{r}
est.calc(dats3, un(dats3), .32)
est.calc(dats3, nor(dats3), .32)
est.calc(dats3, bet(dats3), .32)

```


```{r}
```


```{r}
```


```{r}
```


```{r}
```


```{r}
```


```{r}
```


```{r}
```


```{r}
```


```{r}
```

