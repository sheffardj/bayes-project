---
title: "Untitled"
output: pdf_document
date: "2022-11-17"
---

$$
p(\sigma|x) = \frac{p(\sigma)p(x|\sigma)}{\int p(\sigma)p(x|\sigma)}\\

$$

Working with the logit normal we will first calculate the top of the fraction 
```{r}
library(logitnorm)
library(sn)
```

# the priors 
```{r}
un <- function (d) {
  dunif(d, -1, 1)
  }
nor <- function (d){
  dnorm(d, 0, 1)
  }
bet <- function(d){
  dbeta(d, .5, .5)
}

sn <- function(d){
  dsn(d, .2,.2)
}


```

# funtion to out put the graph and estimates
```{r}
est.calc <- function(prior, s){
  set.seed(0)
  dat <- rlogitnorm(15000, 0, s) 
  
  simps_three8 <- function(f, a, b, n){
  # function f
  # [a,b] interval of integration
  # n = number of BIG subdivisions (will be multiplied by three to include middle ones)
  nn = 3*n+1
  h = (b - a)/n
  xx <- seq(a, b, length=nn)
  y = f(xx)
  
  h*( y[1] + y[nn] + 3*sum(y[(2:(nn-1))[2:(nn-1)%%3!=1]])  + 2*sum(y[(2:(nn-1))[2:(nn-1)%%3==1]]) )/8
  }
  
  tests <- function (x){
  dlogitnorm(dat, 0 , x)*prior(dat)
  } 
  dnom <- simps_three8(tests, 0,1, 1000) 
  
  est <- mean((dlogitnorm(dat, 0, s)*prior(dat))/dnom)
  

  hist(dat, probability = T, ylim = c(0,5))
  curve(dlogitnorm(x, 0, s), col = 'red', add = T)
  curve(dlogitnorm(x, 0, est), col ='blue', add = T)
  print(est)
}




```

# logitnorm sigma = 3.16
```{r}
est.calc( un, 3.16)
est.calc( nor, 3.16)
est.calc( bet, 3.16)
est.calc( sn, 3.16)

```

# logitnorm with sigma = 1.78
```{r}
est.calc( un, 1.78)
est.calc( nor, 1.78)
est.calc( bet, 1.78)
est.calc(sn, 1.78)
```

#logitnorm sigma = .32
```{r}
est.calc( un, .32)
est.calc( nor, .32)
est.calc( bet, .32)
est.calc( sn, .32)
```
# mu est function 
```{r}
est.mu <- function(prior, mu){
  set.seed(0)
  dat <- rlogitnorm(15000, mu, 1) 
  
  simps_three8 <- function(f, a, b, n){
  # function f
  # [a,b] interval of integration
  # n = number of BIG subdivisions (will be multiplied by three to include middle ones)
  nn = 3*n+1
  h = (b - a)/n
  xx <- seq(a, b, length=nn)
  y = f(xx)
  
  h*( y[1] + y[nn] + 3*sum(y[(2:(nn-1))[2:(nn-1)%%3!=1]])  + 2*sum(y[(2:(nn-1))[2:(nn-1)%%3==1]]) )/8
  }
  
  tests <- function (x){
  dlogitnorm(dat, x , 1)*prior(dat)
  } 
  dnom <- simps_three8(tests, 0,1, 1000) 
  
  estm <- mean(((dlogitnorm(dat, mu, 1)*prior(dat))/dnom))
  
  
  

  hist(dat, probability = T, ylim = c(0,5))
  curve(dlogitnorm(x, mu, 1), col = 'red', add = T)
  curve(dlogitnorm(x, estm, 1), col ='blue', add = T)
  print(estm)
}



```

# mu = 0
```{r}
est.mu( un, 0)
est.mu( nor, 0)
est.mu( bet, 0)
est.mu( sn, 0)

```

# mu = 1
```{r}
est.mu( un, 1)
est.mu( nor, 1)
est.mu( bet, 1)
est.mu( sn, 1)
```

# mu = 2
```{r}
est.mu( un,  2)
est.mu( nor, 2)
est.mu( bet, 2)
est.mu( sn,  2)
```


```{r}
```


```{r}
```


```{r}
```


```{r}
```


```{r}
```


```{r}
```

